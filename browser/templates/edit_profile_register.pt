<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="context/@@groupserver_site_home_layout/page">
  <head>
    <title metal:fill-slot="title">
      <span tal:replace="string:${view/label}: ${view/userName}: ${view/siteInfo/get_name}">
        Edit Profile
      </span>
    </title>
    <tal:block metal:fill-slot="style">
     <link rel="stylesheet" 
      type="text/css" media="screen" 
      href="/++resource++wymeditor-20080123/skins/default/screen.css" />
    </tal:block>
  </head>
  <body>
    <tal:block metal:fill-slot="contextnavigation">
    </tal:block>
    <tal:block metal:fill-slot="sitenavigation">
      <div id="sitenavigation" />
    </tal:block>
    <tal:block metal:fill-slot="utilitylinks">
      <div id="utilitylinks" />
    </tal:block>
    <div metal:fill-slot="messages" tal:condition="view/status" 
      class="message-error"
      tal:define="e view/errors"
      tal:attributes="class python:e and 'message-error' or 'message-result'">
      <p class="form-status" tal:content="structure view/status"/>
      <dl tal:condition="view/errors">
        <tal:block repeat="widget view/widgets">
          <tal:block tal:condition="widget/error">
            <dt tal:content="widget/label">Widget Name</dt>
            <dd class="error" 
              tal:content="structure widget/error">Error message</dd>
          </tal:block>
        </tal:block>
      </dl>
    </div>
    <tal:block metal:fill-slot="body">
      <form enctype="multipart/form-data"  method="post" action="."
        tal:attributes="action request/URL" id="edit-profile">
        
        <h1 tal:content="view/label">Edit Profile</h1>
        <p>
          Welcome!
          An email message has been sent to your email account, asking you
          to verify that you control the address
          <code class="email" 
            tal:content="python:view.userEmail[0]">your@email.address</code>.
          You can now edit your profile, while waiting for the message to 
          arrive in your email inbox.
          When you have finished, click the 
          <samp class="button" 
            tal:define="action python:[a for a in view.actions][0].label"
            tal:content="action">Big R</samp> 
          button.
        </p>
        <p>
          Most of your profile properties are only visible to other
          logged in users of
          <span class="site" 
            tal:content="view/siteInfo/get_name">this site</span>,
          when they visit your profile page.
          However, if you post to a public group, then your name and 
          image will be visible to all visitors to that group, even if
          they are not logged in.
          You will be able to change all your profile properties later.
        </p>
        <div id="privacy" class="disclosureWidget">
          <p>
            <a class="disclosureButton" id="privacy-button"
              href="javascript:showHideDisclosure('privacy')">Your privacy 
              is important, and will be maintained  according to the 
              privacy policy of 
              <span class="site" tal:content="siteName">this site</span>.</a>
          </p>
          <div class="disclosureShowHide" style="display: none;">
            <div id="privacy-content">Loading&#8230;</div>
          </div>
        </div>
        <tal:block repeat="widget view/widgets">
          <div class="form-widget" id="widget-abc123" 
            tal:define="req widget/required;
              style python:req and 'required' or 'not-required'"
            tal:attributes="id string:widget-${widget/name};
              class string:form-widget ${style}">

            <label for="abc123" title="The hint for the widget"
              tal:condition="python:(not hasattr(widget, 'type')) or widget.type != 'checkbox'"
              tal:attributes="for widget/name; title widget/hint"
              tal:content="widget/label">
              A label
            </label>
                        
            <p class="error" tal:condition="widget/error"
              tal:content="structure widget/error">
              Error message
            </p>
            
            <span
              tal:condition="python:hasattr(widget, 'tag')"
              tal:replace="structure widget">Widget</span>
              
            <span class="readonlyWidget"
              tal:condition="python:not(hasattr(widget, 'tag'))"
              tal:content="structure widget"/>
            
            <label for="abc123" title="The hint for the widget"
              tal:condition="python:hasattr(widget, 'type') and widget.type == 'checkbox'"
              tal:attributes="for widget/name; title widget/hint"
              tal:content="widget/label">
              A label
            </label>
          </div><!--form-widget-->
        </tal:block>
        <div class="buttons" tal:condition="view/availableActions">
          <tal:block repeat="action view/actions">
            <div class="formelementbutton">
              <span tal:replace="structure action/render">Button</span>
            </div>
          </tal:block>
        </div>
      </form>
    </tal:block>
    <tal:block metal:fill-slot="javascript">
      <script type="text/javascript"
        src="/++resource++check_required-20071214.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++popup_help-20071218.js">&#160;</script>
      <script type="text/javascript"
        tal:define="rws python:[w for w in view.widgets if w.required];
          rwIds python:['\'#%s\''%w.name.replace('.','\\\\.') for w in rws];
          arr python:'%s' % ', '.join(rwIds);">
        jQuery.noConflict()
        jQuery(document).ready( function () {
            var gsRequiredWidgets = new Array(<span tal:replace="arr" />);
            GSCheckRequired.init(
              gsRequiredWidgets, 
              '#form\\.actions\\.edit');
              
            GSPopupFormHelp.init('#edit-profile');

            jQuery("#privacy-button").click( function () {
                var gsUri = "/about/policies/privacy/ #privacy";
                jQuery("#privacy-content").load(gsUri);
            });
        });
      </script>
      <script type="text/javascript" 
        src="/++resource++wymeditor-20080123/jquery.wymeditor.pack.js">&#160;</script>
      <script type="text/javascript" 
        src="/++resource++wymeditor-20080123/init.js">&#160;</script>
    </tal:block>
  </body>
</html>

