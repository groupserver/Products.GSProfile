<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="context/@@groupserver_site_home_layout/page">
  <head>
    <title metal:fill-slot="title">
      <span tal:replace="string:${view/label}: ${view/userInfo/name}: ${view/siteInfo/get_name}"/>
    </title>
    <!--=mpj17=-->
    <!--
      All forms submit to themselves, as the view handles the data, as it
      does with the XForms in GroupServer 0.9. We always post, as the form
      may have a side-effect.
      
      2007-08-23
    -->
  </head>
  <body>
    <tal:block metal:fill-slot="contextnavigation">
    </tal:block>
    <tal:block metal:fill-slot="sitenavigation">
      <div id="sitenavigation">&#160;</div>
    </tal:block>
    <tal:block metal:fill-slot="utilitylinks">
      <div id="utilitylinks">&#160;</div>
    </tal:block>
    <div metal:fill-slot="messages" tal:condition="view/status" 
      class="message-error"
      tal:define="e view/errors"
      tal:attributes="class python:e and 'message-error' or 'message-result'">
      <p class="form-status" tal:content="structure view/status"/>
      <dl tal:condition="view/errors">
        <tal:block repeat="widget view/widgets">
          <tal:block tal:condition="widget/error">
            <dt tal:content="widget/label">Widget Name</dt>
            <dd class="error" 
              tal:content="structure widget/error">Error message</dd>
          </tal:block>
        </tal:block>
      </dl>
    </div>
    <tal:block metal:fill-slot="body">
      <h1 tal:content="view/label">Set Password</h1>
      <p>
        Welcome, 
        <span class="fn" 
          tal:content="view/userInfo/get_name">user</span>!
        All you need to do now is set your password and you will be able
        to enjoy your online groups.
        To set your password, enter it in the entry below, repeat
        it in the entry below that, and click
        the
        <samp class="button"
          tal:define="action python:[a for a in view.actions][0].label"
          tal:content="action">Big R</samp>
        button.
      </p>
      <form enctype="multipart/form-data"  method="post" action="."
        id="set-password" tal:attributes="action request/URL">
        <tal:block define="widgets python:[w for w in view.widgets][:2]">
          <tal:block replace="structure provider:groupserver.FormWidgets"/>
        </tal:block>
        <tal:block define="widget python:[w for w in view.widgets][2]">
          <span tal:replace="structure widget/hidden">Widget</span>
        </tal:block>
        <div id="passwordHelp">
          <p class="message-error" style="display: none;">
            The passwords do not match.
            Please retype your password in the 
            <samp class="entry">Password</samp> and 
            <samp class="entry">Confirm Password</samp> entries so
            they match.
          </p>
        </div><!--Password Help-->
        <div class="buttons" tal:condition="view/availableActions">
          <tal:block repeat="action view/actions">
            <div class="formelementbutton">
              <span tal:replace="structure action/render">Button</span>
            </div>
          </tal:block>
        </div><!--buttons-->
      </form>
    </tal:block>
    <tal:block metal:fill-slot="javascript">
      <script type="text/javascript" 
        src="++resource++jquery-1.2.1.min.js">&#160;</script>      
      <script type="text/javascript" 
        src="++resource++check_password-20080212.js">&#160;</script>
      <script type="text/javascript"
        src="/++resource++popup_help-20071218.js">&#160;</script>
      <script type="text/javascript">
          jQuery.noConflict();
          jQuery(document).ready( function () {
              GSCheckPassword.init('#form\\.password1', 
                  '#form\\.password2', '#form\\.actions\\.set',
                  '#passwordHelp');
              GSPopupFormHelp.init('#set-password');
          });
      </script>
    </tal:block>
  </body>
</html>

